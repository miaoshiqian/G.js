<!DOCTYPE html>
<html>
    <head>
        <title>G.js test</title>
        <script type="text/javascript">
            document.domain = 'gjs.com';
        </script>
        <meta charset="UTF-8" />
        <script type="text/javascript" src="../dist/g-debug.js"  charset="UTF-8"></script>
    </head>
<body>
<div id="mocha"></div>
<script type="text/javascript">
G.config({
    debug   : true,
    servers : ['http://gjs.com'],
    base    : '/src/',
    version : {
        'util/storage/localStorage.js': 100000
    },
    alias   : {
        'jquery': 'lib/jquery/jquery-1.8.2.js',
        'localStorage': 'util/storage/localStorage.js'
    },
    combine : {
        'util/storage/storage.cmb.js': ['localStorage', './cookie.js', '.flashCookie.js']
    }
});
G.use(['require', 'Promise', './expect.js', './mocha.js', './mocha.css'], function ( require ) {
    var mocha = require('./mocha.js');
    var Promise = require('Promise');
    var allTest = [];
    mocha.setup('bdd');
    var gConfigTest = Promise.defer();
    allTest.push(gConfigTest);
    G.use(['./test_case/gConfig.test.js'], function (test) {
        test(gConfigTest);
    });

    // test localStorage
    var localStorageTest = Promise.defer();
    allTest.push(localStorageTest);
    G.use(['./test_case/localStorage.test.js'], function (test) {
        test(localStorageTest);
    });

    Promise.when(allTest).done(function () {
        mocha.run().globals(['match']);
    });
});
</script>
</body>
</html>